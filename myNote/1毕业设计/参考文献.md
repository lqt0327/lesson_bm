引言
商务模块库的本质是页面可视化搭建，页面可视化搭建是一个历久弥新的话题，更广义上讲，页面是GUI的一部分，GUI的拖拉生成在各种地方都很常见，早在几十年前，前端页面就可以用Dreamweaver，Frontpage等工具可视化搭建出来。不过现在已经很少人使用Dreamweaver了，其主要原因是页面承载的内容已经和页面源码分离，变为了由后端返回再渲染到页面，静态页面网站无法承载大量的动态内容。虽然Dreamweaver死了，但是页面可视化搭建工具依然广泛需要和使用，所以这个话题依然值得探讨。
可视化页面搭建的研究内容
对于页面可视化的研究，主要集中在如何将复杂的页面抽象成结构化的数据，由结构数据驱动组件/模版的拼装。或许这一句话很好理解，按照该想法也能构建出一个可用的平台，但是能否更进一步，想要在技术和业务上突破瓶颈，还需要打通更多的环节：
（1）结构化数据如何设计才能够兼顾优雅和高性能，并且天然支持活动编辑时的“时光旅行”功能
（2）如何平衡页面的自由发挥和规范统一
（3）如何突破原始模版引擎，借力框架组件化思想，并且做到framework free
（4）如何优雅实现专题模版功能，一键导入功能以及插拔式编辑
（5）如何贴合自身业务特点，平衡实用性、适用性和可扩展性
（6）如何不断持续迭代，以适应新的需求发展
（7）如何最大发挥可配置，如何最大化方便接入方便扩展
（8）如何避免组件枚举堆积的混乱
想要开始可视化页面搭建的研究，我们需先了解一些概念，动态逻辑页面可分解为HTML Tree，Data和Dynamic Logic三个部分。前端开发工程师开发前端页面的过程，本质上使用编程工具对页面的HTML Tree，Data和Dynamic Logic进行增删和修改。页面可视化搭建，是用可视化交互的方式对页面的HTML Tree，Data和Dynamic Logic进行增删和修改，从而实现页面的生成。前端服务化，更广泛的来讲，为页面小白、运营人员、产品人员提供的页面可视化生成工具，也是赋予以上人员前端开发的能力。所以页面可视化搭建本质上是前端服务化的一部分。
有了以上对于可视化页面搭建的认知，我们接下来便可以开始可视化页面搭建的研究。页面可视化搭建工具的区分维度包括：系统功能、面向客群、编辑自由度。
系统功能：
页面可视化搭建工具的系统功能是指该工具在解决特定页面可视化搭建问题上提供的核心能力。页面是由HTML Tree，Data和Dynamic Logic三部分组成的，一个页面可视化搭建工具提供的能力是编辑页面组成部分之一或多部分。对于急于组件的页面，其可编辑单元为组件，此时采用Component Tree概念取代HTML Tree。
（1）HTML Tree编辑：这类页面搭建工具专注于可视化地编辑页面HTML Tree部分，一般可以对页面做自由度较高的编辑。其关键功能在于高自由度：几乎可以编辑页面可见的所有元素，能够自由修改页面结构、页面元素样式和页面数据，采用类似Word，Photoshop的可视化编辑方式。这类工具一般只适用于生成逻辑比较简单的页面，现市面上的这类工具有：百度H5、iH5等。
（2）Component Tree编辑：这类页面搭建工具针对组件化的页面，主要实现Component Tree的可视化编辑。其核心功能在于页面布局设计：在UI组件列表中选择合适的组件，通过拖拽的方式将组件嵌入到页面中，生成带布局和样式的页面。现市面上的这类工具有：ice阿里飞冰、vue-layout等。
（3）页面Data编辑：这类页面搭建工具专注于可视化地编辑页面的Data部分，如图片的URL、按钮文本、按钮跳转链接等。这类搭建工具主要针对HTML Tree比较固定、能承载复杂业务逻辑的页面。HTML Tree固定的常见方式是页面组件化，只需修改页面组件的Data就能快速地生成页面。其核心功能在于快速搭建承载业务逻辑的页面。通常营销活动页面就采用这种方式来可视化搭建。现市面上的这类工具有：阿里云凤蝶、开源的pipeline等。
（4）Dynamic Logic编辑：这类页面搭建工具支持在界面上输入逻辑代码，实现页面Dynamic Logic编辑，如后台接口请求逻辑，业务逻辑判断等。这些逻辑代码需要有合适的插入点，一般在事件钩子中提供插入点，如页面onload、网络请求状态变更、按钮事件、逻辑变更等。做到可以支持编辑Dynamic Logic是一件很厉害的事情，这类工具对于页面的理解最为深入，对开发者的技术能力、前端架构能力和开发能力都有着很高的要求。
面向客群：
页面可视化搭建工具的面向客群是指工具的使用客群。不同的使用客群，其对页面技术的认识程度、搭建页面的诉求有所不同，所以可以从工具的面向客群来区分不同工具。
（1）前端小白：前端小白是不具有前端知识的人群，他们对页面可视化搭建工具的诉求是交互性越高越好。最适合他们的工具是像：Word，Powerpoint，Photoshop等具有丰富交互功能，且所见即所得的页面搭建工具。同时他们也不关心最后用什么方式托管到互联网上，页面编辑完成后要帮他们在公网上托管页面, 并提供页面链接。
（2）运营、产品人员没有开发人员页面开发、逻辑编程的能力, 他们的诉求是可以快速搭建活动、产品页面。 活动、产品页面是承载着业务逻辑的: 如包含领取优惠券功能、背景音乐播放功能、产品购买功能等。 运营、产品对页面可视化搭建的另一个诉求是“快速”: 一天好几个活动, 怎么快怎么来。面向运营、产品的可视化搭建工具, 需要将页面的逻辑功能封装在页面区块内, 支持通过点击来选择区块, 然后在表单中编辑区块所需数据，只对页面进行少量编辑就完成业务页面搭建。
（3）中后台开发人员：中后台开发人员具有逻辑编程能力, 但其前端开发能力比较弱. 中后台开发人员的诉求是, 在开发中后台系统的 Web 管理端时, 不需要进行重度的前端页面结构和样式开发, 可以专注在逻辑和数据处理上。要求页面可视化搭建工具提供页面搭建的区块, 对区块进行可视化组合来输出一个基本的前端页面; 并在页面搭建工具上提供业务逻辑编写的输入点, 或将基本前端页面源码导出到 IDE 中供中后台开发人员进行业务逻辑的开发。
编辑自由度
页面可视化搭建工具的编辑自由度, 是指页面可编辑单元的粒度。前端页面的可编辑单元为 HTML 元素; 从前端页面组件化的角度, 页面可编辑单元为组件。不同的编辑自由度的选择, 是可视化搭建工具在不同业务场景下编辑自由度与编辑效率的平衡。
（1）编辑自由度为 HTML 元素：编辑自由度为 HTML 元素的页面搭建工具有以下特点: 可编辑的元素丰富、页面结构灵活、可视化编辑效率较低、业务逻辑封装度较低。这类工具的可编辑单元为 HTML 元素, 可以编辑元素的文本、样式和行为, 可编辑的元素较丰富; 并且可以组合各种 HTML 元素到页面中, 生成的页面结构灵活; 从生成页面的角度, 编辑出一个页面需要从基本的 HTML 元素开始搭建, 可视化编辑的工作量较大; 一个业务功能的实现, 通常需要渲染多个 HTML 元素, 而这类工具可以自由增删业务所需的 HTML 元素, 这导致无法固定地承载业务功能, 所以这类编辑工具生成的页面, 业务逻辑封装程度较低。
（2）编辑自由度为前端框架组件：编辑自由度为前端框架组件的页面搭建工具有以下特点: 可编辑的元素依赖搭建工具提供的组件, 可视化编辑效率较高、业务逻辑封装度较高。这类工具的可编辑单元为前端框架的组件, 这些组件需要开发并导入到页面可视化搭建工具中; 组件的渲染结果包含了多个 HTML 元素, 所以从生成页面的角度, 编辑出一个页面只需要组合组件, 可以较快速完成页面生成; 组件本身承载了特定的业务功能, 所以这类编辑器生成的页面, 业务逻辑封装程度较高。对于嵌套的组件, 需要重点解决组件数据流和组件布局适配。
（3）不嵌套的前端框架组件：移动端的页面, 常用的布局策略是: 宽度铺满, 高度滚动.。如果前端框架组件都设置为铺满宽度, 页面展示时组件只需在浏览器垂直方向上顺序排列, 则组件组合时候不需要嵌套, 所有组件互为兄弟节点。这种铺满宽度的组件, 非常适合搭建移动端页面的场景: 在承载页面逻辑的同时, 使得页面的编辑更加简单, 使用者只需要处理组件的顺序, 不需要处理组件的嵌套。
研究评述
理想的页面可视化搭建框架需要对页面做一些约定和约束, 在可视化搭建时遵循工具约定和约束来编辑页面。更全面讨论页面可视化搭建工具时, 不只是关注工具本身的功能, 还需要关注工具的依赖和约束, 如页面可视化搭建工具的组件化方式、模板组织方式、编辑功能实现方式等。 从工具开发的角度说, 页面可视化搭建工具是需要架构设计的, 不同工具的区分, 其实是不同的页面可视化搭建框架间的差异。理想的运营页面可视化搭建框架：（1）采用 JSON Schema 声明配置数据, 配置表单自动生成。（2）采用组件化和页面模板实现页面生成效率的提升。（3）编辑系统与组件、前端框架、模板解耦。（4）在遵循编辑系统约定下, 组件可以自由拓展, 前端框架可以自由选择。想要实现理想中的页面可视化搭建，还要着许多方面的思考和实践，可视化页面搭建工具目前还远没有到达理想的样子，仍需要我们开发人员不断的研究。
参考文献
[1] 柳伟卫.《node.js企业级应用开发实战》. 北京：北京大学出版社,2020.7
[2] 程墨.《深入浅出react和redux》.北京: 机械工业出版社，2017.5
[3] 李隆隆.《可视化页面编辑平台的设计与实现》.硕士论文.中国知网.2018
[4] 张宝玉.  浅析HTTPS协议的原理及应用[J]. 网络安全技术与应用. 2016
[5] 王金龙,宋斌,丁锐.  Node.js:一种新的Web应用构建技术[J]. 现代电子技术. 2015
[6] 骆斌.需求工程[M]. 高等教育出版社, 2014
[7] 钟强.  Node.JS平台下Web前端架构的研究[J]. 无线互联科技. 2013 (12)
[8] 李艳.  商业智能的支撑技术[J]. 海淀走读大学学报. 2004 (01)
[9] (美)弗兰纳根.《javascript权威指南》. 北京：机械工业出版社.2012
[10] The world’’s most popular open source database. https://www.mysql.com/ . 2017
[11] Tilkov, Stefan,Vinoski, Steve.  Node.js: Using JavaScript to Build High-Performance Network Programs[J]. IEEE Internet Computing . 2010 (6)
[12] M Cook,D Kline,T Pence,T Janicki.Extending Data Visualization in Salesforce with React and Redux. . 2017